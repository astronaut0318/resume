# 用户注册用例文档

## 1. 用例说明

本用例描述了用户在系统中进行注册的完整流程，包括表单验证、数据校验以及注册成功后的处理。

## 2. 用例流程

### 2.1 基本流程

1. 用户访问注册页面
2. 用户填写注册表单，包括用户名、密码、手机号和邮箱
3. 用户提交注册表单
4. 系统验证表单数据的有效性
5. 系统检查用户名、手机号和邮箱的唯一性
6. 系统创建新用户账号，并分配默认角色
7. 系统返回注册成功信息

### 2.2 替代流程

#### 表单验证失败
1. 用户提交表单
2. 系统检测到表单数据不符合要求（如用户名长度不足、密码太简单等）
3. 系统返回详细的错误信息
4. 用户修正输入并重新提交

#### 用户名已存在
1. 用户提交表单
2. 系统检测到用户名已被注册
3. 系统返回"用户名已存在"错误
4. 用户选择其他用户名并重新提交

#### 手机号已存在
1. 用户提交表单
2. 系统检测到手机号已被注册
3. 系统返回"手机号已存在"错误
4. 用户修改手机号并重新提交

#### 邮箱已存在
1. 用户提交表单
2. 系统检测到邮箱已被注册
3. 系统返回"邮箱已存在"错误
4. 用户修改邮箱并重新提交

## 3. API接口说明

### 3.1 用户注册接口

- **URL**: `/api/users/register`
- **方法**: POST
- **描述**: 注册新用户
- **请求参数**:

```json
{
  "username": "zhangsan",
  "password": "password123",
  "email": "zhangsan@example.com",
  "phone": "13800138000"
}
```

- **响应结果**:

```json
{
  "code": 200,
  "message": "注册成功",
  "data": {
    "userId": 1,
    "username": "zhangsan"
  }
}
```

### 3.2 检查用户名是否可用

- **URL**: `/api/users/check/username`
- **方法**: GET
- **描述**: 检查用户名是否已被注册
- **请求参数**: username (查询参数)
- **响应结果**:

```json
{
  "code": 200,
  "message": "操作成功",
  "data": true  // true表示可用，false表示已存在
}
```

### 3.3 检查手机号是否可用

- **URL**: `/api/users/check/phone`
- **方法**: GET
- **描述**: 检查手机号是否已被注册
- **请求参数**: phone (查询参数)
- **响应结果**:

```json
{
  "code": 200,
  "message": "操作成功",
  "data": true  // true表示可用，false表示已存在
}
```

### 3.4 检查邮箱是否可用

- **URL**: `/api/users/check/email`
- **方法**: GET
- **描述**: 检查邮箱是否已被注册
- **请求参数**: email (查询参数)
- **响应结果**:

```json
{
  "code": 200,
  "message": "操作成功",
  "data": true  // true表示可用，false表示已存在
}
```

## 4. 业务规则

1. 用户名必须唯一，长度为4-20个字符
2. 密码长度必须在6-20个字符之间
3. 手机号必须符合中国大陆手机号格式（如13800138000）
4. 邮箱必须符合标准邮箱格式
5. 新注册用户默认分配"普通用户"角色（roleId=2）
6. 用户状态默认为正常(status=0)，删除标志默认为未删除(isDeleted=0)

## 5. 安全考虑

1. 密码在服务端使用BCrypt算法加密存储
2. 防止注册表单的重复提交
3. 接口参数需进行严格验证，防止非法输入

## 6. 测试用例

1. 正常注册场景：所有字段有效且不冲突
2. 用户名冲突场景：使用已存在的用户名
3. 手机号冲突场景：使用已存在的手机号
4. 邮箱冲突场景：使用已存在的邮箱
5. 表单验证场景：各字段不符合格式要求 