# 用户模块开发指南

## 一、模块介绍

用户模块是简历系统的基础模块，负责用户账户的管理，包括用户注册、登录、信息查询、修改等功能，同时提供用户详细信息管理和VIP会员管理功能。

## 二、技术选型

- Spring Boot 2.7.14
- Spring Cloud 2021.0.8
- Nacos：服务注册与配置中心
- MyBatis Plus 3.5.2：ORM框架
- MySQL 8.0.28：数据库
- Druid 1.2.8：数据库连接池
- Swagger/Knife4j：API文档

## 三、目录结构

```
user-service/
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── com/
│   │   │       └── ptu/
│   │   │           ├── UserServiceApplication.java  # 启动类
│   │   │           └── user/
│   │   │               ├── controller/               # 控制器层
│   │   │               │   └── UserController.java
│   │   │               ├── dto/                      # 数据传输对象
│   │   │               │   ├── RegisterDTO.java
│   │   │               │   ├── UserDetailDTO.java
│   │   │               │   ├── UserDetailUpdateDTO.java
│   │   │               │   └── UserVipDTO.java
│   │   │               ├── entity/                   # 实体类层
│   │   │               │   ├── UserEntity.java
│   │   │               │   ├── UserDetailEntity.java
│   │   │               │   └── UserVipEntity.java
│   │   │               ├── mapper/                   # 数据访问层
│   │   │               │   ├── UserMapper.java
│   │   │               │   ├── UserDetailMapper.java
│   │   │               │   └── UserVipMapper.java
│   │   │               ├── service/                  # 服务层
│   │   │               │   ├── UserService.java      # 用户服务接口
│   │   │               │   ├── UserDetailService.java # 用户详细信息服务接口
│   │   │               │   ├── UserVipService.java   # 用户VIP服务接口
│   │   │               │   └── impl/
│   │   │               │       ├── UserServiceImpl.java        # 用户服务实现
│   │   │               │       ├── UserDetailServiceImpl.java  # 用户详细信息服务实现
│   │   │               │       └── UserVipServiceImpl.java     # 用户VIP服务实现
│   │   │               └── vo/                       # 视图对象
│   │   │                   ├── RegisterVO.java
│   │   │                   ├── UserDetailVO.java
│   │   │                   └── UserVipVO.java
│   │   └── resources/
│   │       ├── application.yml                      # 应用配置
│   │       └── bootstrap.yml                        # 引导配置
│   └── test/                                        # 测试目录
└── pom.xml                                          # 项目依赖
```

## 四、功能说明

### 1. 基础用户管理
- 用户注册
- 用户信息查询
- 用户状态管理
- 密码管理（验证密码、更新密码）

### 2. 用户详细信息管理
- 获取用户详细信息
- 创建用户详细信息
- 更新用户详细信息

### 3. VIP会员管理
- 获取用户VIP会员信息
- 开通VIP会员
- 续费VIP会员
- 升级VIP等级

### 4. API接口

#### 基础用户管理接口

| 接口名称 | 请求方式 | 接口路径 | 接口说明 |
| ---- | ---- | ---- | ---- |
| 用户注册 | POST | /users/register | 注册新用户 |
| 根据ID获取用户 | GET | /users/{id} | 根据用户ID查询用户信息 |
| 根据用户名获取用户 | GET | /users/by-username/{username} | 根据用户名查询用户信息 |
| 分页查询用户列表 | GET | /users/page | 分页查询用户列表，支持条件筛选 |
| 修改用户状态 | PUT | /users/{id}/status/{status} | 修改用户状态 |
| 重置密码 | PUT | /users/{id}/reset-password | 重置用户密码 |
| 验证用户密码 | POST | /users/verify-password | 验证用户密码是否正确 |
| 更新用户密码 | POST | /users/update-password | 更新用户密码 |

#### 用户详细信息管理接口

| 接口名称 | 请求方式 | 接口路径 | 接口说明 |
| ---- | ---- | ---- | ---- |
| 获取用户详细信息 | GET | /users/{userId}/details | 获取用户的详细信息 |
| 更新用户详细信息 | PUT | /users/{userId}/details | 更新或创建用户详细信息 |

#### VIP会员管理接口

| 接口名称 | 请求方式 | 接口路径 | 接口说明 |
| ---- | ---- | ---- | ---- |
| 获取VIP会员信息 | GET | /users/{userId}/vip | 获取用户的VIP会员信息 |
| 开通VIP会员 | POST | /users/{userId}/vip/open | 为用户开通VIP会员 |
| 续费VIP会员 | POST | /users/{userId}/vip/renew | 为用户续费VIP会员 |
| 升级VIP等级 | POST | /users/{userId}/vip/upgrade | 升级用户的VIP等级 |

## 五、数据库设计

### 1. 用户表(user)

| 字段名 | 数据类型 | 可空 | 默认值 | 说明 |
| ---- | ---- | ---- | ---- | ---- |
| id | bigint | 否 | 自增 | 主键ID |
| username | varchar(50) | 否 | 无 | 用户名 |
| password | varchar(100) | 否 | 无 | 密码 |
| phone | varchar(20) | 是 | null | 手机号码 |
| email | varchar(100) | 是 | null | 邮箱 |
| avatar | varchar(255) | 是 | null | 头像URL |
| role | tinyint | 否 | 0 | 角色：0-普通用户，1-VIP用户，2-管理员 |
| status | tinyint | 否 | 1 | 账号状态：0-禁用，1-正常 |
| last_login_time | datetime | 是 | null | 最后登录时间 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 更新时间 |
| deleted | tinyint | 否 | 0 | 删除标志：0-未删除，1-已删除 |

### 2. 用户详细信息表(user_detail)

| 字段名 | 数据类型 | 可空 | 默认值 | 说明 |
| ---- | ---- | ---- | ---- | ---- |
| id | bigint | 否 | 自增 | 主键ID |
| user_id | bigint | 否 | 无 | 用户ID，关联user表 |
| real_name | varchar(50) | 是 | null | 真实姓名 |
| gender | tinyint | 是 | 0 | 性别：0-未知，1-男，2-女 |
| birthday | date | 是 | null | 出生日期 |
| education | varchar(50) | 是 | null | 学历 |
| work_years | int | 是 | null | 工作年限 |
| address | varchar(255) | 是 | null | 地址 |
| profile | text | 是 | null | 个人简介 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 更新时间 |
| deleted | tinyint | 否 | 0 | 删除标志：0-未删除，1-已删除 |

### 3. 用户VIP会员表(user_vip)

| 字段名 | 数据类型 | 可空 | 默认值 | 说明 |
| ---- | ---- | ---- | ---- | ---- |
| id | bigint | 否 | 自增 | 主键ID |
| user_id | bigint | 否 | 无 | 用户ID，关联user表 |
| level | tinyint | 否 | 1 | VIP等级：1-初级，2-中级，3-高级 |
| start_time | datetime | 否 | CURRENT_TIMESTAMP | 开始时间 |
| end_time | datetime | 否 | 无 | 结束时间 |
| create_time | datetime | 否 | CURRENT_TIMESTAMP | 创建时间 |
| update_time | datetime | 否 | CURRENT_TIMESTAMP | 更新时间 |
| deleted | tinyint | 否 | 0 | 删除标志：0-未删除，1-已删除 |

## 六、开发进度

- [x] 项目基础结构搭建
- [x] 用户实体类定义
- [x] 用户详细信息实体类定义
- [x] 用户VIP会员实体类定义
- [x] 用户服务接口及实现类开发
- [x] 用户详细信息服务接口及实现类开发
- [x] 用户VIP会员服务接口及实现类开发
- [x] 用户控制器开发（包括基础用户管理、详细信息管理和VIP会员管理）
- [x] 用户相关DTO/VO开发
- [x] 密码管理功能开发（验证密码、更新密码）
- [ ] 单元测试编写
- [ ] 集成测试编写
- [ ] 文档完善 