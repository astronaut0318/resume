# 模板服务开发指南

## 一、模块介绍

模板服务（Template Service）是简历系统的核心模块之一，负责简历模板的管理、分类、检索和收藏等功能。模板服务提供丰富的简历模板供用户选择，支持模板预览、下载和使用，同时通过分类和搜索功能帮助用户快速找到适合的简历模板。

## 二、技术选型

- **Spring Boot 2.7.14**: 基础框架
- **Spring Cloud 2021.0.8**: 微服务框架
- **MyBatis Plus 3.5.2**: ORM框架
- **MySQL 8.0.28**: 数据库
- **Redis 6.0+**: 缓存服务
- **MinIO**: 对象存储，用于存储模板文件和缩略图
- **Nacos**: 服务注册和配置中心
- **Sentinel**: 熔断限流
- **Feign**: 服务间调用
- **Swagger/Knife4j**: 接口文档

## 三、目录结构

```
template-service/
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── com/
│   │   │       └── ptu/
│   │   │           ├── TemplateServiceApplication.java  # 启动类
│   │   │           └── template/
│   │   │               ├── config/                      # 配置类
│   │   │               │   ├── MinioConfig.java         # MinIO配置
│   │   │               │   ├── RedisConfig.java         # Redis配置
│   │   │               │   ├── MybatisPlusConfig.java   # MybatisPlus配置 
│   │   │               │   └── SwaggerConfig.java       # Swagger配置
│   │   │               ├── controller/                  # 控制器
│   │   │               │   ├── TemplateCategoryController.java  # 模板分类控制器
│   │   │               │   ├── TemplateController.java          # 模板控制器
│   │   │               │   └── TemplateCollectionController.java # 模板收藏控制器
│   │   │               ├── service/                    # 服务接口
│   │   │               │   ├── TemplateCategoryService.java     # 模板分类服务接口
│   │   │               │   ├── TemplateService.java             # 模板服务接口
│   │   │               │   ├── TemplateCollectionService.java   # 模板收藏服务接口
│   │   │               │   └── impl/                    # 服务实现
│   │   │               │       ├── TemplateCategoryServiceImpl.java
│   │   │               │       ├── TemplateServiceImpl.java
│   │   │               │       └── TemplateCollectionServiceImpl.java
│   │   │               ├── mapper/                     # Mapper接口
│   │   │               │   ├── TemplateCategoryMapper.java      # 模板分类Mapper
│   │   │               │   ├── TemplateMapper.java              # 模板Mapper
│   │   │               │   └── TemplateCollectionMapper.java    # 模板收藏Mapper
│   │   │               ├── entity/                     # 实体类
│   │   │               │   ├── TemplateCategoryEntity.java      # 模板分类实体类
│   │   │               │   ├── TemplateEntity.java              # 模板实体类
│   │   │               │   └── TemplateCollectionEntity.java    # 模板收藏实体类
│   │   │               ├── dto/                        # 数据传输对象
│   │   │               │   ├── TemplateCategoryDTO.java         # 模板分类DTO
│   │   │               │   ├── TemplateDTO.java                 # 模板DTO
│   │   │               │   └── TemplateCollectionDTO.java       # 模板收藏DTO
│   │   │               ├── vo/                         # 视图对象
│   │   │               │   ├── TemplateCategoryVO.java          # 模板分类VO
│   │   │               │   ├── TemplateVO.java                  # 模板VO
│   │   │               │   ├── TemplateDetailVO.java            # 模板详情VO
│   │   │               │   ├── TemplateCollectionVO.java        # 模板收藏VO
│   │   │               │   └── TemplateShareVO.java             # 模板分享VO
│   │   │               ├── util/                      # 工具类（MinioUtils和RedisUtils已移至common-service模块）
│   │   │               ├── exception/                 # 异常处理
│   │   │               │   └── GlobalExceptionHandler.java      # 全局异常处理
│   │   │               └── common/                    # 公共类
│   │   │                   ├── constants/                       # 常量定义
│   │   │                   ├── enums/                           # 枚举类
│   │   │                   └── query/                           # 查询参数
│   │   └── resources/
│   │       ├── application.yml         # 应用配置
│   │       ├── bootstrap.yml           # 引导配置
│   │       ├── mapper/                 # MyBatis XML映射文件
│   │       │   ├── TemplateCategoryMapper.xml
│   │       │   ├── TemplateMapper.xml
│   │       │   └── TemplateCollectionMapper.xml
│   │       └── 模板服务开发指南.md      # 开发指南文档
│   └── test/                          # 测试类
└── pom.xml                            # 项目依赖
```

## 四、数据库设计

### 1. 模板分类表(template_categories)

| 字段名 | 类型 | 说明 | 约束 |
| ----- | ---- | ---- | ---- |
| id | bigint | 主键ID | PRIMARY KEY, AUTO_INCREMENT |
| name | varchar(50) | 分类名称 | NOT NULL |
| sort | int | 排序值 | NOT NULL, DEFAULT 0 |
| status | tinyint | 状态(0-禁用,1-启用) | NOT NULL, DEFAULT 1 |
| create_time | datetime | 创建时间 | NOT NULL |
| update_time | datetime | 更新时间 | NOT NULL |

### 2. 模板表(templates)

| 字段名 | 类型 | 说明 | 约束 |
| ----- | ---- | ---- | ---- |
| id | bigint | 主键ID | PRIMARY KEY, AUTO_INCREMENT |
| category_id | bigint | 分类ID | NOT NULL, FOREIGN KEY |
| name | varchar(100) | 模板名称 | NOT NULL |
| thumbnail | varchar(255) | 缩略图URL | NOT NULL |
| file_path | varchar(255) | 模板文件URL | NOT NULL |
| price | decimal(10,2) | 价格 | NOT NULL, DEFAULT 0.00 |
| is_free | tinyint | 是否免费(0-付费,1-免费) | NOT NULL, DEFAULT 0 |
| downloads | int | 下载次数 | NOT NULL, DEFAULT 0 |
| description | varchar(500) | 模板描述 | DEFAULT NULL |
| status | tinyint | 状态(0-下架,1-上架) | NOT NULL, DEFAULT 1 |
| create_time | datetime | 创建时间 | NOT NULL |
| update_time | datetime | 更新时间 | NOT NULL |

### 3. 模板收藏表(template_collection)

| 字段名 | 类型 | 说明 | 约束 |
| ----- | ---- | ---- | ---- |
| id | bigint | 主键ID | PRIMARY KEY, AUTO_INCREMENT |
| user_id | bigint | 用户ID | NOT NULL |
| template_id | bigint | 模板ID | NOT NULL, FOREIGN KEY |
| create_time | datetime | 收藏时间 | NOT NULL |

## 五、核心功能

### 1. 模板分类管理

- 获取分类列表：提供模板分类数据，支持排序
- 分类CRUD：管理员可以创建、更新、删除分类

### 2. 模板管理

- 模板列表：获取模板列表，支持分页和筛选（按分类、免费/付费、关键词）
- 模板详情：获取模板的详细信息
- 模板上传：管理员可以上传新模板（包括模板文件和缩略图）
- 模板更新：管理员可以更新现有模板
- 模板删除：管理员可以删除模板

### 3. 模板收藏功能

- 收藏模板：用户可以收藏喜欢的模板
- 取消收藏：用户可以取消已收藏的模板
- 收藏列表：获取用户收藏的模板列表

### 4. 模板分享功能

- 分享模板：生成模板分享链接
- 分享访问：通过分享链接访问模板

## 六、API接口

模板服务提供以下API接口，详细接口文档参考Swagger或项目API文档：

1. 获取模板分类列表：`GET /api/templates/categories`
2. 获取模板列表：`GET /api/templates`
3. 获取模板详情：`GET /api/templates/{templateId}`
4. 收藏模板：`POST /api/templates/{templateId}/collect`
5. 取消收藏：`DELETE /api/templates/{templateId}/collect`
6. 获取收藏列表：`GET /api/templates/collections`
7. 分享模板：`GET /api/templates/{templateId}/share`

管理员接口：
1. 创建模板分类：`POST /api/admin/template-categories`
2. 更新模板分类：`PUT /api/admin/template-categories/{categoryId}`
3. 删除模板分类：`DELETE /api/admin/template-categories/{categoryId}`
4. 上传模板：`POST /api/admin/templates`
5. 更新模板：`PUT /api/admin/templates/{templateId}`
6. 删除模板：`DELETE /api/admin/templates/{templateId}`

## 七、开发进度

### 基础架构
- [x] 项目依赖配置
- [x] 基础配置文件
- [x] 启动类
- [x] 配置类（Redis、MinIO、MyBatis-Plus、Swagger）
- [x] 全局异常处理

### 数据层
- [x] 实体类定义
- [x] Mapper接口
- [x] XML映射文件
- [x] 数据库脚本

### 业务层
- [ ] 模板分类服务
- [ ] 模板服务
- [ ] 模板收藏服务
- [ ] 工具类

### 控制层
- [ ] 模板分类控制器
- [ ] 模板控制器
- [ ] 模板收藏控制器

### 测试与文档
- [ ] 单元测试
- [ ] 接口测试
- [x] 文档完善 