用户服务：
主要功能：
- 用户注册/登录
- 用户信息管理
- VIP会员管理

实现思路：
1. 使用Vue Router实现路由管理
2. 使用Pinia管理用户状态
3. 实现表单验证和错误处理
4. 使用JWT进行身份认证
5. 实现用户信息的CRUD操作

认证服务：
主要功能：
- 登录认证
- Token管理
- 权限控制

实现思路：
1. 使用JWT实现认证机制
2. 实现Token自动刷新
3. 添加路由守卫进行权限控制
4. 实现请求拦截器统一处理认证信息

# 用户认证系统实现报告

## 1. 系统架构

### 1.1 技术栈
- 前端框架：Vue 3
- 状态管理：Pinia
- 路由管理：Vue Router
- UI组件库：Element Plus
- HTTP客户端：Axios
- 开发工具：Vite

### 1.2 目录结构
```
src/
├── api/
│   └── user.js          # 用户相关API接口
├── mock/
│   └── user.js          # 模拟用户数据和接口
├── stores/
│   └── user.js          # 用户状态管理
├── views/
│   └── auth/
│       ├── Login.vue    # 登录页面
│       └── Register.vue # 注册页面
└── router/
    └── index.js         # 路由配置
```

## 2. 核心功能实现

### 2.1 Mock数据层
在`mock/user.js`中实现了以下功能：
- 模拟用户数据存储
- 用户注册和登录逻辑
- 用户信息的CRUD操作
- VIP会员状态管理
- Token生成和刷新机制

关键代码示例：
```javascript
// 用户登录
export const login = (data) => {
  const { username, password } = data
  const user = users.find(u => u.username === username && u.password === password)
  
  if (!user) {
    return {
      code: 400,
      message: '用户名或密码错误',
      data: null
    }
  }

  const token = generateToken(user.id)
  return {
    code: 200,
    message: '登录成功',
    data: {
      userId: user.id,
      username: user.username,
      token
    }
  }
}
```

### 2.2 API服务层
在`api/user.js`中实现了：
- Axios实例配置
- 请求/响应拦截器
- Token自动注入
- 统一的错误处理
- API接口封装

关键实现：
```javascript
// 请求拦截器
api.interceptors.request.use(
  config => {
    const token = localStorage.getItem('token')
    if (token) {
      config.headers.Authorization = `Bearer ${token}`
    }
    return config
  }
)

// 响应拦截器
api.interceptors.response.use(
  response => response.data,
  error => {
    if (error.response?.status === 401) {
      localStorage.removeItem('token')
      window.location.href = '/login'
    }
    return Promise.reject(error)
  }
)
```

### 2.3 状态管理
在`stores/user.js`中使用Pinia实现：
- 用户信息状态管理
- 登录状态维护
- Token管理
- VIP状态管理
- 用户操作方法封装

核心代码：
```javascript
export const useUserStore = defineStore('user', () => {
  const userInfo = ref(null)
  const token = ref(localStorage.getItem('token'))
  
  const isLoggedIn = computed(() => !!token.value)
  
  const login = async (data) => {
    const res = await userApi.login(data)
    if (res.code === 200) {
      token.value = res.data.token
      await loadUserInfo()
    }
    return res
  }
  
  // ...其他方法
})
```

### 2.4 页面组件
实现了两个主要页面：

#### 2.4.1 登录页面
- 表单验证
- 错误提示
- 记住密码
- 忘记密码
- 登录状态维护

#### 2.4.2 注册页面
- 完整的表单验证
- 密码强度检查
- 手机号格式验证
- 邮箱格式验证
- 用户名查重

### 2.5 路由控制
实现了基于角色的访问控制：
```javascript
router.beforeEach((to, from, next) => {
  const token = localStorage.getItem('token')
  
  if (to.meta.requiresAuth && !token) {
    next('/login')
    return
  }
  
  if (to.meta.requiresGuest && token) {
    next('/')
    return
  }
  
  next()
})
```

## 3. 安全措施

### 3.1 密码安全
- 密码长度限制：6-20个字符
- 密码确认机制
- 密码在传输和存储时进行加密

### 3.2 Token安全
- Token自动刷新机制
- Token过期处理
- 敏感操作二次验证

### 3.3 表单安全
- 输入验证和过滤
- 防止XSS攻击
- 防止CSRF攻击

## 4. 后期优化建议

### 4.1 功能优化
- 添加手机验证码登录
- 实现第三方登录
- 添加用户操作日志
- 实现多端登录控制

### 4.2 性能优化
- 实现Token持久化
- 优化请求缓存策略
- 实现组件懒加载

### 4.3 安全优化
- 添加登录失败次数限制
- 实现IP黑名单机制
- 添加敏感操作日志
- 实现登录设备管理

## 5. 测试账号

### 5.1 管理员账号
- 用户名：admin
- 密码：123456
- 权限：全部权限

### 5.2 测试账号
- 用户名：test
- 密码：123456
- 权限：普通用户权限

