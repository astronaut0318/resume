# 管理员系统功能实现报告

## 1. 功能概述

管理员系统提供了针对网站管理员的特定功能，包括用户管理、模板分类管理等核心功能，主要实现以下功能模块：

- **用户管理功能**：管理员可以查看所有用户列表，搜索用户，禁用/启用用户账号，修改用户角色
- **模板分类管理**：管理员可以查看和创建模板分类
- **权限控制**：基于用户角色的权限控制，确保只有管理员可以访问管理后台
- **UI集成**：在用户界面中集成管理入口，提供直观的管理界面

## 2. 系统角色设计

系统中的用户角色设计如下：

| 角色ID | 角色名称 | 权限描述 |
|--------|---------|---------|
| 0 | 普通用户 | 基础功能使用权限 |
| 1 | VIP会员 | 增强功能使用权限，有时效限制 |
| 2 | 终身会员 | 全部会员功能永久使用权限 |
| 3 | 管理员 | 系统管理权限，可访问管理后台 |

## 3. 技术实现

### 3.1 数据模拟

创建了管理员相关的API模拟数据，在`src/mock/admin.js`中实现：

```javascript
// 模拟用户列表数据
const userList = [
  {
    id: 1,
    username: 'admin',
    email: 'admin@example.com',
    phone: '13800138000',
    role: 3,  // 3-管理员
    status: 1,
    createTime: '2023-01-01 12:00:00'
  },
  // 其他用户数据...
]

// 模拟模板分类数据
const templateCategories = [
  {
    id: 1,
    name: '简约风格',
    sort: 1
  },
  // 其他分类数据...
]

// API实现：获取用户列表、更新用户状态、更新用户角色、创建模板分类等
```

### 3.2 权限控制实现

在用户模型中添加`isAdmin`计算属性，用于判断用户是否具有管理员权限：

```javascript
// 在用户store中添加
const isAdmin = computed(() => {
  return userInfo.value?.role === 3
})
```

使用Vue Router的导航守卫实现管理页面的权限控制：

```javascript
// 路由守卫示例
router.beforeEach((to, from, next) => {
  // 检查是否需要管理员权限
  if (to.meta.requiresAdmin) {
    if (userStore.isAdmin) {
      next()
    } else {
      next({ path: '/403' })
    }
  } else {
    next()
  }
})
```

### 3.3 管理员UI实现

在管理后台中实现了以下主要页面：

1. **用户管理页面**：展示用户列表，支持按用户名、邮箱、角色和状态筛选，实现分页功能
2. **用户操作功能**：允许管理员修改用户状态（启用/禁用）和角色（普通用户/VIP/终身会员）
3. **模板分类管理**：允许查看和创建新的模板分类

### 3.4 关键代码

用户状态和角色管理的核心代码：

```javascript
// 更新用户状态API
export const updateUserStatus = (userId, status) => {
  const userIndex = userList.findIndex(user => user.id === parseInt(userId))
  
  if (userIndex === -1) {
    return {
      code: 404,
      message: '用户不存在',
      data: null
    }
  }
  
  userList[userIndex].status = status
  
  return {
    code: 200,
    message: '操作成功',
    data: null
  }
}

// 更新用户角色API
export const updateUserRole = (userId, role) => {
  const userIndex = userList.findIndex(user => user.id === parseInt(userId))
  
  if (userIndex === -1) {
    return {
      code: 404,
      message: '用户不存在',
      data: null
    }
  }
  
  userList[userIndex].role = role
  
  return {
    code: 200,
    message: '操作成功',
    data: null
  }
}
```

## 4. 用户界面展示

根据用户角色，在前端界面上显示不同的标识：

```html
<div class="user-level">
  <el-tag v-if="userInfo?.role === 3" type="danger">管理员</el-tag>
  <el-tag v-else-if="userInfo?.role === 2" type="success">终身会员</el-tag>
  <el-tag v-else-if="userInfo?.role === 1" type="warning">VIP会员</el-tag>
  <el-tag v-else type="info">普通用户</el-tag>
</div>
```

在页面头部为管理员提供后台入口：

```html
<el-dropdown-item v-if="isAdmin" @click="router.push('/admin')">
  管理后台
</el-dropdown-item>
```

## 5. 登录流程优化

为管理员用户优化了登录流程，使管理员可以直接通过登录页面进入管理后台：

```javascript
// 登录成功后的处理
const handleLoginSuccess = (data) => {
  userStore.setToken(data.token)
  userStore.setUserId(data.userId)
  
  // 如果是管理员，直接跳转到管理后台
  if (userStore.isAdmin) {
    router.push('/admin')
  } else {
    router.push('/dashboard')
  }
}
```

## 6. 总结与展望

目前管理员系统已经实现了基础的用户管理和模板分类管理功能，可以满足网站日常运营需求。未来可以考虑增加以下功能：

1. 更详细的用户数据统计和分析功能
2. 更完善的模板管理功能，包括审核、上架、下架等
3. 系统运营数据监控和报表功能
4. 更细粒度的权限控制系统

通过Mock API的方式实现了管理员功能的前端部分，为后期与后端API对接奠定了基础。
